---
title: Поворот АВАТАРОВ
author: admin
type: post
date: 2012-12-31T17:09:19+00:00
url: /povorot-avatarov/
categories:
  - Css 3

---
Давайте взглянем на синтаксис функции трансформации, которая позволит нам немного повернуть аватары. Добавьте в таблицу стилей новое правило:

<div>
  <p>
    Удобный генератор трансформаций CSS, расположенный по адресу <a href="http://westciv.com/tools/">http://westciv.com/tools/</a> transforms, умеет создавать код для самых разных трансформаций. Это может здорово помочь в ежедневной работе.
  </p>
</div>

&nbsp;

.comment-meta img {

-moz-transform: rotate(-5deg); -o-transform: rotate(-5deg); -webkit-transform: rotate(-5deg); transform: rotate(-5deg);

Свойство transform без префикса пока что не поддерживается ни одним из браузеров; мы добавим его для обеспечения совместимости в будущем.

Слово transform (и на этот раз я имею в виду все три эквивалента для разных браузеров) сообщает браузеру, что вы желаете применить трансформацию. После этого вы говорите, что в данный момент вас интересует функция трансформации rotate, а угол поворота равен -5 градусам, на что указывает значение -5deg. Можно использовать как положительные, так и отрицательные значения. Разные функции трансформации принимают разные параметры (значение -5deg ни о чем не скажет функции масштабирования, не так ли?) однако принцип записи функций всегда одинаков:

transform: функция(параметры);

Для задания источника трансформации, т. е. точки, относительно которой трансформируется объект, можно использовать свойство transform-origin. Например, можно указать в качестве источника трансформации центр объекта или его правый верхний угол. По умолчанию трансформирование осуществляется относительно неподвижного центра, что нас в данном случае вполне устраивает, поэтому мы не будем добавлять свойство transform-origin.

Сохраните страницу и обновите ее в окне браузера. Вы увидите, что теперь аватары отображаются под небольшим углом.

<a href="http://formstyle.com.ua/?attachment_id=1781" rel="attachment wp-att-1781"><img class="aligncenter size-full wp-image-1781" alt="теперь аватары отображаются под небольшим углом." src="http://formstyle.com.ua/wp-content/uploads/2012/12/теперь-аватары-отображаются-под-небольшим-углом..png" width="112" height="457" /></a>

На момент написания этой главы в Chrome существуют большие проблемы со сглаживанием контуров аватаров после поворота. Края картинок получаются очень зазубренными, и избежать этого невозможно. Можно либо удалить из объявления свойства строку с префиксом -webkit- (при этом в Safari картинки также поворачиваться не будут), либо смириться с неровностью линий.

Функция трансформации rotate поворачивает аватары пользователей

Обходные пути для IE

Фильтр для IE под названием Matrix умеет эмулировать некоторые трансформации CSS3. К сожалению, для поиска правильных значений параметров фильтра приходится выполнять сложные расчеты в матричной форме. Полагаю, вы в данный момент читаете книгу по веб-дизайну как раз потому, что математика вас слабо интересует, так что я не буду загружать вас деталями расчетов (да и все равно не сумею объяснить все толком). Позвольте мне лучше подсказать вам адрес генератора CSS, созданного Золтаном Гаврилюком (Zoltan Hawryluk) и вашей покорной слугой, который называется IE’s CSS3 Transforms Translator, — вы найдете его на странице <http://www.useragentman.com/IETransformsTranslator>.

Для начала введите в поле Step 1 (Шаг 1) значение rotate(-5deg) и любые значения ширины (поле Width) и высоты (поле Height) (мы не будем их использовать, но их необходимо указывать для того, чтобы инструмент работал). Затем щелкните на кнопке Translate to IE Matrix (Преобразовать в матрицу IE). Чуть ниже появится второе поле под названием Step 2 (Шаг 2), содержащее два блока кода — один для браузеров, поддерживающих CSS3, а второй для IE (рис. 2.26).

Скопируйте код из поля для IE и добавьте его к стилям, вставив внутрь тега head. Удалите из кода CSS все комментарии.

#transformedObject {

-ms-filter: &#171;progid:DXImageTransform.Microsoft.

&#8212;    Matrix(M11=0.9961946980917454, M12=0.08715574274765871,

&#8212;    M21=-0.08715574274765871, M22=0.9961946980917454,

&#8212;    SizingMethod=&#8217;auto expand&#8217;)&#187;;

filter: progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454,

M12=0.08715574274765871,

M21=-0.08715574274765871,

M22=0.9961946980917454,

SizingMethod=&#8217;auto expand&#8217;); margin-left: -11px; margin-top: -11px;

<sup>}</sup>

Данное правило включает свойство filter для IE 6 и 7, а также свойство -ms-filter для версии IE 8. Обратите внимание, что в показанном выше фрагменте кода внутри фильтра -ms-filter присутствуют разрывы строк. Они добавлены только для того, чтобы код поместился на страницу книги, — эти символы не генерируются инструментом Transforms Translator. Убедитесь, что в вашем файле свойство -ms-filter целиком помещается на одной строке, иначе оно работать не будет. Свойство filter работает как с разрывами строк, так и без. Значения margin необходимы, так как IE выбирает не те источники трансформации, что другие браузеры, и аватары из-за этого немного перекрывают имена комментаторов. Указывая значения полей или используя относительное позиционирование, вы перемещаете элементы на нужное место, поэтому страница выглядит одинаково во всех браузерах.

<a href="http://formstyle.com.ua/?attachment_id=1791" rel="attachment wp-att-1791"><img class="aligncenter size-full wp-image-1791" alt="Значения margin необходимы, так как IE выбирает не те источники трансформации" src="http://formstyle.com.ua/wp-content/uploads/2012/12/Значения-margin-необходимы-так-как-IE-выбирает-не-те-источники-трансформации.png" width="340" height="686" srcset="http://formstyle.com.ua/wp-content/uploads/2012/12/Значения-margin-необходимы-так-как-IE-выбирает-не-те-источники-трансформации.png 340w, http://formstyle.com.ua/wp-content/uploads/2012/12/Значения-margin-необходимы-так-как-IE-выбирает-не-те-источники-трансформации-148x300.png 148w" sizes="(max-width: 340px) 100vw, 340px" /></a>

Инструмент Transforms Translator генерирует значения матрицы IE, эквивалентные указанным значениям 2D-трансформации в CSS3

Теперь необходимо поменять селектор, чтобы он соответствовал названию трансформируемого элемента, в данном случае .comment-meta img. Мы также должны разделить одно правило на два: первое для IE 6 и 7, а второе для IE 8. Не забудьте включить значения margin в оба правила.

.ie6 .comment-meta img, .ie7 .comment-meta img {

filter: progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454,

M12=0.08715574274765871,

M21=-0.08715574274765871,

M22=0.9961946980917454,

SizingMethod=&#8217;auto expand&#8217;); margin-left: -11px; margin-top: -11px;

.ie8 .comment-meta img {

-ms-filter: &#171;progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454, M12=0.08715574274765871,

&#8212;    M21=-0.08715574274765871, M22=0.9961946980917454,

&#8212;    SizingMethod=&#8217;auto expand&#8217;)&#187;; margin-left: -11px; margin-top: -11px;

<sup>}</sup>

Если вы сохраните страницу и откроете ее в IE, то обнаружите, что все прекрасно работает в IE 7, но в IE 6 верхушки изображений обрезаются, а в IE 8 изображения немного перекрывают имена комментаторов (рис. 2.27).

Инструмент Transforms Translator генерирует значения матрицы IE, эквивалентные указанным значениям 2D-трансформации в CSS3

Теперь необходимо поменять селектор, чтобы он соответствовал названию трансформируемого элемента, в данном случае .comment-meta img. Мы также должны разделить одно правило на два: первое для IE 6 и 7, а второе для IE 8. Не забудьте включить значения margin в оба правила.

.ie6 .comment-meta img, .ie7 .comment-meta img {

filter: progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454,

M12=0.08715574274765871,

M21=-0.08715574274765871,

M22=0.9961946980917454,

SizingMethod=&#8217;auto expand&#8217;); margin-left: -11px; margin-top: -11px;

.ie8 .comment-meta img {

-ms-filter: &#171;progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454, M12=0.08715574274765871,

&#8212;    M21=-0.08715574274765871, M22=0.9961946980917454,

&#8212;    SizingMethod=&#8217;auto expand&#8217;)&#187;; margin-left: -11px; margin-top: -11px;

<sup>}</sup>

Если вы сохраните страницу и откроете ее в IE, то обнаружите, что все прекрасно работает в IE 7, но в IE 6 верхушки изображений обрезаются, а в IE 8 изображения немного перекрывают имена комментаторов (рис. 2.27).

<a href="http://formstyle.com.ua/?attachment_id=1801" rel="attachment wp-att-1801"><img class="aligncenter size-full wp-image-1801" alt="изображения немного перекрывают имена комментаторов" src="http://formstyle.com.ua/wp-content/uploads/2012/12/изображения-немного-перекрывают-имена-комментаторов.png" width="112" height="451" /></a>

Причина проблемы в IE 6 заключается в отрицательных значениях полей изображений — когда изображение выходит за пределы поля, IE 6 не отображает «лишние» фрагменты. Для того чтобы исправить ситуацию, добавьте к правилу для IE 6 и 7 строку position: relative:

.ie6 .comment-meta img, .ie7 .comment-meta img {

filter: progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454, M12=0.08715574274765871, M21=-0.08715574274765871, M22=0.9961946980917454,

SizingMethod=&#8217;auto expand&#8217;); margin-left: -11px; margin-top: -11px; position: relative;

<div>
  <p>
    В IE 8 поворот изображений выполняется правильно, но аватары немного перекрывают имена комментаторов
  </p>
  
  <p>
    <sup>}</sup>
  </p>
  
  <p>
    В IE 8 проблема с наложением возникает из-за того, что отрицательные значения полей не согласуются с другими стилями, использующимися на странице. Давайте применим для размещения изображений относительное позиционирование, а не настройку полей:
  </p>
  
  <p>
    .ie6 .comment-meta img, .ie7 .comment-meta img {
  </p>
  
  <p>
    filter: progid:DXImageTransform.Microsoft.Matrix( M11=0.9961946980917454, M12=0.08715574274765871, M21=-0.08715574274765871, M22=0.9961946980917454,
  </p>
  
  <p>
    SizingMethod=&#8217;auto expand&#8217;); position: relative; top: -5px; left: -5px;
  </p>
  
  <p>
    .ie8 .comment-meta img {
  </p>
  
  <p>
    -ms-filter: &#171;progid:DXImageTransform.Microsoft.
  </p>
  
  <p>
    &#8212;    Matrix(M11=0.9961946980917454, M12=0.08715574274765871,
  </p>
  
  <p>
    &#8212;    M21=-0.08715574274765871, M22=0.9961946980917454,
  </p>
  
  <p>
    &#8212;    SizingMethod=&#8217;auto expand&#8217;)&#187;; position: relative; top: -5px; left: -5px;
  </p>
  
  <p>
    <sup>}</sup>
  </p>
  
  <p>
    Благодаря этим изменениям аватары теперь поворачиваются в IE 6, 7 и 8 так же, как в браузерах с поддержкой функций трансформирования CSS3, не перекрывают имена комментаторов внизу и не вылезают на текст комментария справа.
  </p>
  
  <div>
    <p>
      Не забывайте, что разрывы строк внутри свойства -ms-filter добавлены только для форматирования текста в книге. Удостоверьтесь, что в вашем коде это свойство записано в одной строке.
    </p>
  </div>
  
  <p>
    &nbsp;
  </p>
  
  <p>
    Вместо того чтобы напрямую применять фильтр Matrix, можно воспользоваться помощью готового сценария, который выполняет необходимые расчеты незаметно от вас. Преимущество такого подхода заключается в том, что позже вам будет намного проще внести в сценарий различные изменения для трансформаций, например для создания эффекта анимации и прочих. Сценарий cssSandpaper (http://www.useragentman.com/ blog/csssandpaper-a-css3-javascript-library), также авторства Zoltan Hawryluk, заставляет несколько функций трансформации, а также box-shadow, градиенты, RGBA и HSLA работать в IE. Сценарий Transformie автора Paul Bakaus (http://paulbakaus.com/?p=11) немного проще и основан на jQuery.
  </p>
  
  <p>
    <a name="bookmark17"></a>Готовая страница
  </p>
  
  <p>
    Мы закончили стилизацию комментариев; откройте готовую страницу в современном браузере, и вы увидите, что теперь она выглядит как на рис. 2.28. Сравните результат с рис. 2.1, где показана базовая страница. Радикальных отличий нет, но второй вариант визуально насыщеннее и выглядит уникальным и привлекательным.
  </p>
  
  <div>
    <p>
      Завершенная страница со всеми описанными эффектами называется speech-bubble_final.html. Она находится в папке с остальными файлами упражнений для этой главы.
    </p>
  </div>
  
  <p>
    &nbsp;
  </p>
  
  <p>
    В браузере IE некоторые эффекты отсутствуют, но в целом результат на рис. 2.29 похож на рис. 2.28. С небольшими различиями можно смириться; мы добавили исключительно декоративные эффекты, и пользователям IE не будет казаться, что на странице чего-то не хватает. Даже если вы решите не добавлять обходные пути для IE, такие как фильтры, рассмотренные в этой главе, страница в IE 8 будет выглядеть как на рис. 2.1 и прекрасно работать.
  </p>
  
  <p>
    <a href="http://formstyle.com.ua/?attachment_id=1811" rel="attachment wp-att-1811"><img class="aligncenter size-full wp-image-1811" alt="страница в IE 8 будет выглядеть как на рис" src="http://formstyle.com.ua/wp-content/uploads/2012/12/страница-в-IE-8-будет-выглядеть-как-на-рис.png" width="617" height="358" srcset="http://formstyle.com.ua/wp-content/uploads/2012/12/страница-в-IE-8-будет-выглядеть-как-на-рис.png 617w, http://formstyle.com.ua/wp-content/uploads/2012/12/страница-в-IE-8-будет-выглядеть-как-на-рис-300x174.png 300w" sizes="(max-width: 617px) 100vw, 617px" /></a>
  </p>
</div>