---
title: Размещение изображений с помощью background-clip
author: admin
type: post
date: 2013-01-03T17:46:43+00:00
url: /razmeshhenie-izobrazhenij-s-pomoshhyu-background-clip/
categories:
  - Css 3

---
Теперь вдоль левого края блока div аккуратно выводятся копии нашего изображения кромки вырванной из блокнота страницы. Однако осталась проблема — фоновое изображение видно сквозь «дыры» на бумаге (рис. 3.19). Так происходит потому, что рамка по умолчанию отображается поверх фоновой области. Возможно, раньше вы этого не замечали, так как чаще всего в качестве рамки используются одноцветные линии без прозрачных участков. Попробуйте ради эксперимента добавить к свойству border-style ключевое слово dashed, и вы поймете, что я имею в виду. Изображения на рамки накладываются по такому же принципу.

порядок следования свойств, описывающих фон элемента

Чаще всего порядок записи свойств в правиле не играет роли; я просто перечисляю свойства в привычном для меня порядке, но вы можете выбрать другой вариант компоновки содержимого правила. Тем не менее свойство background-clip необходимо всегда записывать после составного свойства background, как показано, потому что, по идее, background-clip можно добавлять внутрь составного свойства background (см. рис. 3.10). Если сначала записать в коде отдельное свойство background-clip, а затем добавить свойство background, не включающее background-clip, браузер поймет это как приказ использовать значение по умолчанию (border-box) и переопределить первоначальные параметры background-clip.

Почему бы просто не добавить нужное значение background-clip в составное свойство background? Это невозможно. Есть причины, запрещающие нам пока что включать значения background-clip в свойство background: некоторые браузеры требуют наличия префиксов и пока что не могут справиться с ситуацией, когда стандартное свойство без префиксов добавляется в составное свойство background.

коротко о свойстве background-clip

Свойство background-clip входит в модуль Backgrounds and Borders (Фон и границы), описание которого вы найдете по адресу http://www.w3.org/TR/css3-background. Оно позволяет указать секции элемента, под которыми должен отображаться фон.

Допустимые значения свойства: border-box (значение по умолчанию, фон отображается под рамками), padding-box (фон обрезается по внешним краям полей внутренней области, т. е. по внутренним краям рамок) и content-box (фон обрезается по краю области содержимого и не отображается под полями и рамками). Firefox 3.6 и более ранние версии не поддерживают content-box и используют значения border и padding, а не border-box и padding-box; в Firefox 4 этот недостаток уже устранен. Safari 5 поддерживает значения border-box и padding-box в стандартном свойстве background-clip, но в свойстве -webkit-background-clip позволяет использовать только content-box.

Webkit также поддерживает значение text, однако его можно использовать только в свойстве с префиксом -webkit. Это ключевое слово превращает текст в маску: вы видите фон только под буквами, а все остальное фоновое пространство, лежащее за пределами текста, скрывается. Мне такой эффект очень нравится, но он вряд ли попадет в спецификацию. Более подробную информацию и примеры вы найдете на страницах http://www.css3.info/ webkit-introduces-background-cliptext, http://trentwalton.com/2010/03/24/css3-background-clip-text, и http://trentwalton.com/2010/04/06/css3-background-clip-font-face.

Помимо обрезки фона по краю рамки, свойство background-clip можно применять для решения следующих задач:

•    удаление одноцветного фона или фонового изображения из-под пунктирной или точечной рамки;

•    имитация двойной рамки с помощью content-box: одна рамка настоящая, а вторую имитируют поля внутренней области элемента;

•    обрезка фона таким образом, чтобы он не вылезал за пределы скругленных углов и кромок элемента, как иногда случается в браузерах на базе Webkit. Для этого применяется ключевое слово padding-box (см. http://tumble.sneak.co.nz/post/928998513/ fixing-the-background-bleed).

Поддержка свойства background-clip в браузерах

<table border="1">
  <tr>
    <td>
      IE
    </td>
    
    <td>
      Firefox
    </td>
    
    <td>
      Opera
    </td>
    
    <td>
      Safari
    </td>
    
    <td>
      Chrome
    </td>
  </tr>
  
  <tr>
    <td>
      Да, начиная с версии 9
    </td>
    
    <td>
      Да, начиная с версии 4; частично, начиная с версии 1, с префиксом -moz-
    </td>
    
    <td>
      Да
    </td>
    
    <td>
      Да, начиная с версии 3, с префиксом -webkit-; частично, начиная с версии 5
    </td>
    
    <td>
      Да
    </td>
  </tr>
</table>

К счастью, CSS3 позволяет изменить поведение по умолчанию. Вы можете управлять местоположением фона по отношению к рамкам, применяя свойство background-clip. Значение по умолчанию, border-box, соответствует стандартному варианту оформления, когда фон есть и под внутренней областью, и под рамками. Со значением padding-box фон обрезается по внутреннему краю рамки, под полями внутренней области элемента:

#paper {

float: left; margin: 40px;

padding: 3.2em 1.6em 1.6em 1.6em; border-width: 0 0 0 50px;

-moz-border-image: url(images/edge.png) 0 0 0 50 round; -webkit-border-image: url(images/edge.png) 0 0 0 50  round;

border-image: url(images/edge.png) 0 0 0 50 round; background: url(images/paperlines.gif) #FBFBF9; background: url(images/thumbtack.png) 50% 5px no-repeat,

url(images/stains1.png) 90% -20px no-repeat, url(images/stains2.png) 30% 8% no-repeat, url(images/stains3.png) 20% 50% no-repeat, url(images/stains4.png) 40% 60% no-repeat, url(images/paperlines.gif) #FBFBF9;

-moz-background-size: auto, auto, auto, auto, auto, auto 1.6em;

-webkit-background-size: auto, auto, auto, auto, auto, auto 1.6em;

background-size: auto, auto, auto, auto, auto, auto 1.6em;

-moz-background-clip: padding;

-webkit-background-clip: padding-box; background-clip: padding-box;

<sup>}</sup>

Стандартное свойство работает в Chrome, Safari 5, Firefox 4 и Opera, а в Firefox 3.6, Safari 4 и более ранних версиях используются версии с префиксом. Также обратите внимание на свойство -moz-background-clip: там используется ключевое слово padding, а не стандартное padding-box.

Благодаря такому изменению фоновое изображение теперь начинается рядом с рамкой, а не под ней (рис. 3.20).

<div>
  <p>
    Свойство background-clip позволяет подвинуть фоновое изображение и вынести его из-под изображения рамки
  </p>
  
  <p>
    <a href="http://formstyle.com.ua/?attachment_id=2141" rel="attachment wp-att-2141"><img class="aligncenter size-full wp-image-2141" alt="Свойство background-clip позволяет подвинуть фоновое изображение" src="http://formstyle.com.ua/wp-content/uploads/2012/12/Свойство-background-clip-позволяет-подвинуть-фоновое-изображение.png" width="310" height="450" srcset="http://formstyle.com.ua/wp-content/uploads/2012/12/Свойство-background-clip-позволяет-подвинуть-фоновое-изображение.png 310w, http://formstyle.com.ua/wp-content/uploads/2012/12/Свойство-background-clip-позволяет-подвинуть-фоновое-изображение-206x300.png 206w" sizes="(max-width: 310px) 100vw, 310px" /></a>
  </p>
  
  <p>
    Обходные пути для не поддерживающих эту возможность браузеров
  </p>
  
  <p>
    Пользователи браузеров, не поддерживающих свойство border-image, не узнают о том, что на странице чего-то не хватает? — они увидят обычный аккуратный линованный фон. Если вы считаете, что добавить оборванный край необходимо, то реализуйте вариант с еще одним фоновым изображением в дополнительном обрамляющем блоке div, как рассказывается выше.
  </p>
  
  <p>
    Если вы прибегнете к этому способу, вам придется либо удалить свойство border-image из кода для всех остальных браузеров, либо скрыть дополнительное фоновое изображение от браузеров, поддерживающих border-image. Мне больше по душе второй подход — он более гибкий и позволяет создавать рамки с изображениями, не прилагая особых усилий. Примените сценарий Modernizr или условные комментарии IE для создания обрамляющего правила, которое смогут увидеть только определенные браузеры. Это правило должно определять ширину левого поля и фоновое изображение для левого края элемента:
  </p>
  
  <p>
    #wrapper {
  </p>
  
  <p>
    padding-left: 50px;
  </p>
  
  <p>
    background: url(images/edge.png) repeat-y;
  </p>
  
  <p>
    <sup>}</sup>
  </p>
  
  <p>
    Остальные браузеры это правило не увидят. Разумеется, они распознают обрамляющий блок div в коде HTML, но не будут связывать с ним никакие стили.
  </p>
  
  <p>
    В качестве еще одного альтернативного варианта можно объединить изображение линованной бумаги с изображением оборванного края и связать это общее изображение с существующим блоком div под названием paper. Таким образом, вы избавитесь от дополнительного обрамляющего div, однако на реализацию разных фоновых изображений для разных браузеров потребуется затратить больше сил и времени. И снова удостоверьтесь, что в поддерживающих свойство border-image браузерах будут использоваться два разных изображения: одно в качестве фонового, а второе в качестве изображения для рамки. Вместо того чтобы отказываться от свойства border-image в пользу фоновых изображений, можно заставить его работать с помощью сценария. Однако решения на основе сценариев позволяют лишь растягивать изображения для рамки, а не выводить несколько копий, поэтому в нашем случае они неприменимы. Тем не менее если для вашего проекта достаточно будет наложить на рамку растянутое изображение, попробуйте воспользоваться одним из следующих сценариев:
  </p>
  
  <p>
    ■    PIE автора Jason Johnston (http://css3pie.com); подробнее об этом сценарии рассказывается в главе 2. Кстати, он также обеспечивает ограниченную поддержку свойства border-image в IE версий с 6 по 8;
  </p>
  
  <p>
    ■    borderImage автора Louis-Remi Babe (http://github.com/lrbabe/borderimage). Это встраиваемый модуль на основе jQuery, эмулирующий свойство border-image с помощью VML для IE и элемента canvas для остальных браузеров. Более подробное описание и руководство по использованию вы найдете на странице http://www.lrbabe.com/sdoms/borderImage.
  </p>
</div>